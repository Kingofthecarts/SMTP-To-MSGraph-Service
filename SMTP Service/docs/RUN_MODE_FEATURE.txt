================================================================================
RUN MODE CONFIGURATION FEATURE - IMPLEMENTATION SUMMARY
================================================================================

FEATURE OVERVIEW
================

The application now supports configurable run modes through the configuration
file, eliminating the need for command line arguments every time you start it.

You can set your preferred default run mode (Console, Console+Tray, or Tray Only)
in the configuration GUI, and the application will automatically start in that
mode when launched.


RUN MODE OPTIONS
================

0 = Service/Console Mode (Default)
   - Shows console window with real-time logs
   - Good for debugging and troubleshooting
   - Best when you want to see what's happening

1 = Console with Tray Icon
   - Console window with logs + System tray icon
   - Best of both worlds
   - Great for monitoring and quick access to settings
   - Recommended for development and testing

2 = Tray Only
   - System tray icon only, no console window
   - Minimal interface
   - Best for production use
   - Clean and unobtrusive


HOW TO USE
==========

1. Configure Your Preferred Mode:
   - Run "SMTP Service.exe" --tray to open configuration
   - Go to the "Application Settings" tab
   - Select your preferred "Default Run Mode" from the dropdown
   - Click "Save"

2. Start the Application:
   - Simply run "SMTP Service.exe" (no arguments needed)
   - The application will automatically start in your configured mode

3. Override When Needed:
   - Command line arguments still work and override the config setting
   - "SMTP Service.exe" --tray = Force tray-only mode
   - "SMTP Service.exe" --console = Force console+tray mode


CONFIGURATION FILE FORMAT
==========================

The smtp-config.json file now includes:

{
  "ApplicationSettings": {
    "RunMode": 0
  },
  "SmtpSettings": { ... },
  "GraphSettings": { ... },
  "QueueSettings": { ... },
  "LogSettings": { ... }
}


FILES MODIFIED
==============

1. Models/AppConfig.cs
   - Added new ApplicationSettings class with RunMode property
   - RunMode is an integer: 0, 1, or 2

2. Managers/ConfigurationManager.cs
   - Updated CreateDefaultConfiguration() to include ApplicationSettings
   - Default RunMode = 0 (Service/Console mode)

3. Program.cs
   - Reads configuration at startup to check RunMode setting
   - Applies configured RunMode if no command line arguments provided
   - Command line arguments (--tray, --console) override config setting

4. UI/ConfigurationForm.cs
   - Renamed "Queue Settings" tab to "Application Settings"
   - Added ComboBox control for RunMode selection
   - Added descriptive labels explaining each mode
   - Loads/Saves RunMode setting with other configuration

5. Documentation
   - Updated README.md with run mode information
   - Updated PROJECT_NOTES.txt with configuration format
   - Created this RUN_MODE_FEATURE.txt document


IMPLEMENTATION DETAILS
=======================

The logic flow in Program.cs:

1. Load configuration from config/smtp-config.json
2. Check for command line arguments (--tray or --console)
3. If arguments present:
   - Use the argument to determine mode (override config)
4. If NO arguments:
   - Use config.ApplicationSettings.RunMode
   - 0 = Stay in default service/console mode
   - 1 = Enable console + tray mode
   - 2 = Enable tray-only mode
5. Start application in determined mode


BENEFITS
========

✓ No need to remember command line arguments
✓ Consistent startup behavior
✓ Easy to change preferred mode through GUI
✓ Command line arguments still work for one-time overrides
✓ Backward compatible (default = 0, same as before)
✓ User-friendly with descriptive dropdown options


CONFIGURATION GUI
=================

The "Application Settings" tab now shows:

┌─────────────────────────────────────────────────────────┐
│ Application Settings                                     │
├─────────────────────────────────────────────────────────┤
│                                                          │
│ Application Run Mode:                                    │
│                                                          │
│ Default Run Mode:  [Service/Console Mode (Default) ▼]   │
│                                                          │
│ This setting determines how the application runs when    │
│ started without command line arguments.                  │
│ • Service/Console Mode: Shows console with logs          │
│ • Console with Tray: Console logs + system tray icon     │
│ • Tray Only: System tray icon only (minimal interface)   │
│                                                          │
│ Note: Command line arguments (--console or --tray) will  │
│ override this setting.                                   │
│                                                          │
│ ───────────────────────────────────────────────────────  │
│                                                          │
│ Email Queue Settings:                                    │
│                                                          │
│ Max Retry Attempts:    [3]                               │
│ Retry Delay (minutes): [5]                               │
│                                                          │
└─────────────────────────────────────────────────────────┘


TESTING
=======

Test the feature:

1. Set RunMode to 0 in config, run without args:
   ✓ Should show console mode

2. Set RunMode to 1 in config, run without args:
   ✓ Should show console + tray icon

3. Set RunMode to 2 in config, run without args:
   ✓ Should show tray icon only

4. Set RunMode to 1, but run with --tray:
   ✓ Should show tray only (command line overrides)

5. Set RunMode to 2, but run with --console:
   ✓ Should show console + tray (command line overrides)


BACKWARD COMPATIBILITY
======================

✓ Default RunMode = 0 (same behavior as before)
✓ Existing config files automatically get ApplicationSettings section
✓ Command line arguments work exactly as before
✓ No breaking changes to existing functionality


FUTURE ENHANCEMENTS (Optional)
===============================

Possible additions:
- Remember window position and size for console mode
- Auto-minimize console to tray after X minutes
- Different logging levels per run mode
- Notification preferences per run mode


SUPPORT
=======

If you encounter issues:
1. Check that ApplicationSettings section exists in config file
2. Verify RunMode value is 0, 1, or 2
3. Check logs for any startup errors
4. Try deleting config file to regenerate with defaults


VERSION
=======

Feature added: 2025-09-30
Compatible with: v1.0.0+

================================================================================
